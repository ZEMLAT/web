<h1>How to process AlgoSeek intraday NASDAQ 100 data</h1>

<p>You can download a sammle of Algoseek's NASDAQ100 Minute Bar data with Trade &amp; Quote information for 2015-2017 from Algoseek's website <a href="https://www.algoseek.com/ml4t-book-data.html">here</a>. The notebook <a href="1_algoseek_minute_data.ipynb">algoseek<em>minute</em>data</a> contains the code to extract and combine the data that we will use in <a href="../../12_gradient_boosting_machines">Chapter 12</a> to develop a Gradient Boosting model that predicts one-minute returns for an intraday trading strategy.   </p>

<p>Unzip the directory, rename it <code>1min_taq</code>, and move it into a new <code>nasdaq100</code> folder in the <a href="../../data">data</a> directory. It contains around 5GB worth of NASDAQ 100 minute bar data in trade-and-quote format. See <a href="https://us-equity-market-data-docs.s3.amazonaws.com/algoseek.US.Equity.TAQ.Minute.Bars.pdf">documentation</a> for details on the definition of the numerous fields.
The following information is from the Algoseek Trade &amp; Quote Minute Bar data linked above. </p>

<h2>Trade &amp; Quote Minute Bar Fields</h2>

<p>The Quote fields are based on changes to the NBBO (<a href="https://www.investopedia.com/terms/n/nbbo.asp">National Best Bid Offer</a>) from the top-of-book price and size from  each of the exchanges.</p>

<p>The enhanced Trade &amp; Quote bar fields include the following fields:
- <strong>Field</strong>: Name of Field.
- <strong>Q / T</strong>: Field based on Quotes or Trades
- <strong>Type</strong>: Field format
- <strong>No Value</strong>: Value of field when there is no value or data. 
  - Note: “Never” means field should always have a value EXCEPT for the first bar of the day.
- <strong>Description</strong>: Description of the field.</p>

<p>| id  | Field                   | Q/T  | Type                          |  No Value | Description                                                                                                                                                                                                         |
|:---:|-------------------------|:----:|-------------------------------|:---------:|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1  | <code>Date</code>                   |      | YYYYMMDD                      | Never     | Trade Date                                                                                                                                                                                                          |
| 2  | <code>Ticker</code>                 |      | String                       | Never      | Ticker Symbol                                                                                                                                                                                                       |
| 3  | <code>TimeBarStart</code>           |      | HHMM <br>HHMMSS <br>HHMMSSMMM | Never     | For minute bars: HHMM. <br>For second bars: HHMMSS. <br>Examples<br>- One second bar 130302 is from time greater than 130301 to 130302.<br>- One minute bar 1104 is from time greater than 1103 to 1104. |
| 4  | <code>OpenBarTime</code>            | Q    | HHMMSSMMM                    | Never      | Open Time of the Bar, for example one minute:<br>11:03:00.000                                                                                                                                                       |
| 5  | <code>OpenBidPrice</code>           | Q    | Number                        | Never     | NBBO Bid Price as of bar Open                                                                                                                                                                                       |
| 6  | <code>OpenBidSize</code>            | Q    | Number                        | Never     | Total Size from all Exchanges with<br>OpenBidPrice                                                                                                                                                                  |
| 7  | <code>OpenAskPrice</code>           | Q    | Number                        | Never     | NBBO Ask Price as of bar Open                                                                                                                                                                                       |
| 8  | <code>OpenAskSize</code>            | Q    | Number                        | Never     | Total Size from all Exchange with<br>OpenAskPrice                                                                                                                                                                   |
| 9  | <code>FirstTradeTime</code>         | T    | HHMMSSMMM                     | Blank     | Time of first Trade                                                                                                                                                                                                 |
| 10 | <code>FirstTradePrice</code>        | T    | Number                        | Blank     | Price of first Trade                                                                                                                                                                                                |
| 11 | <code>FirstTradeSize</code>         | T    | Number                        | Blank     | Number of shares of first trade                                                                                                                                                                                     |
| 12 | <code>HighBidTime</code>            | Q    | HHMMSSMMM                     | Never     | Time of highest NBBO Bid Price                                                                                                                                                                                      |
| 13 | <code>HighBidPrice</code>           | Q    | Number                        | Never     | Highest NBBO Bid Price                                                                                                                                                                                              |
| 14 | <code>HighBidSize</code>            | Q    | Number                        | Never     | Total Size from all Exchanges with HighBidPrice                                                                                                                                                                  |
| 15 | <code>AskPriceAtHighBidPrice</code> | Q    | Number                        | Never     | Ask Price at time of Highest Bid Price                                                                                                                                                                              |
| 16 | <code>AskSizeAtHighBidPrice</code>  | Q    | Number                        | Never     | Total Size from all Exchanges with <code>AskPriceAtHighBidPrice</code>                                                                                                                                                        |
| 17 | <code>HighTradeTime</code>          | T    | HHMMSSMMM                     | Blank     | Time of Highest Trade                                                                                                                                                                                               |
| 18 | <code>HighTradePrice</code>         | T    | Number                        | Blank     | Price of highest Trade                                                                                                                                                                                              |
| 19 | <code>HighTradeSize</code>          | T    | Number                        | Blank     | Number of shares of highest trade                                                                                                                                                                                   |
| 20 | <code>LowBidTime</code>             | Q    | HHMMSSMMM                     | Never     | Time of lowest Bid                                                                                                                                                                                                  |
| 21 | <code>LowBidPrice</code>            | Q    | Number                        | Never     | Lowest NBBO Bid price of bar.                                                                                                                                                                                       |
| 22 | <code>LowBidSize</code>             | Q    | Number                        | Never     | Total Size from all Exchanges with <code>LowBidPrice</code>                                                                                                                                                                   |
| 23 | <code>AskPriceAtLowBidPrice</code>  | Q    | Number                        | Never     | Ask Price at lowest Bid price                                                                                                                                                                                       |
| 24  | <code>AskSizeAtLowBidPrice</code>  | Q    | Number                        | Never     | Total Size from all Exchanges with <code>AskPriceAtLowBidPrice</code>                                                                                                                                                                                       |
| 25  | <code>LowTradeTime</code>          | T    | HHMMSSMMM                     | Blank     | Time of lowest Trade                                                                                                                                                                                                                             |
| 26  | <code>LowTradePrice</code>         | T    | Number                        | Blank     | Price of lowest Trade                                                                                                                                                                                                                            |
| 27  | <code>LowTradeSize</code>          | T    | Number                        | Blank     | Number of shares of lowest trade                                                                                                                                                                                                                 |
| 28  | <code>CloseBarTime</code>          | Q    | HHMMSSMMM                     | Never     | Close Time of the Bar, for example one minute: 11:03:59.999                                                                                                                                                                                      |
| 29  | <code>CloseBidPrice</code>         | Q    | Number                        | Never     | NBBO Bid Price at bar Close                                                                                                                                                                                                                      |
| 30  | <code>CloseBidSize</code>          | Q    | Number                        | Never     | Total Size from all Exchange with <code>CloseBidPrice</code>                                                                                                                                                                                                |
| 31  | <code>CloseAskPrice</code>         | Q    | Number                        | Never     | NBBO Ask Price at bar Close                                                                                                                                                                                                                      |
| 32  | <code>CloseAskSize</code>          | Q    | Number                        | Never     | Total Size from all Exchange with <code>CloseAskPrice</code>                                                                                                                                                                                                |
| 33  | <code>LastTradeTime</code>         | T    | HHMMSSMMM                     | Blank     | Time of last Trade                                                                                                                                                                                                                               |
| 34  | <code>LastTradePrice</code>        | T    | Number                        | Blank     | Price of last Trade                                                                                                                                                                                                                              |
| 35  | <code>LastTradeSize</code>         | T    | Number                        | Blank     | Number of shares of last trade                                                                                                                                                                                                                   |
| 36  | <code>MinSpread</code>             | Q    | Number                        | Never     | Minimum Bid-Ask spread size. This may be 0 if the market was crossed during the bar.<br/>If negative spread due to back quote, make it 0.                                                                                                            |
| 37  | <code>MaxSpread</code>             | Q    | Number                        | Never     | Maximum Bid-Ask spread in bar                                                                                                                                                                                                                    |
| 38  | <code>CancelSize</code>            | T    | Number                        | 0         | Total shares canceled. Default=blank                                                                                                                                                                                                             |
| 39  | <code>VolumeWeightPrice</code>     | T    | Number                        | Blank     | Trade Volume weighted average price <br>Sum((<code>Trade1Shares</code><em><code>Price</code>)+(<code>Trade2Shares</code></em><code>Price</code>)+…)/<code>TotalShares</code>. <br>Note: Blank if no trades.                                                                                                        |
| 40  | <code>NBBOQuoteCount</code>        | Q    | Number                        | 0         | Number of Bid and Ask NNBO quotes during bar period.                                                                                                                                                                                             |
| 41  | <code>TradeAtBid</code>            | Q,T  | Number                        | 0         | Sum of trade volume that occurred at or below the bid (a trade reported/printed late can be below current bid).                                                                                                                                  |
| 42  | <code>TradeAtBidMid</code>         | Q,T  | Number                        | 0         | Sum of trade volume that occurred between the bid and the mid-point:<br/>(Trade Price > NBBO Bid ) &amp; (Trade Price &lt; NBBO Mid )                                                                                                                       |
| 43  | <code>TradeAtMid</code>            | Q,T  | Number                        | 0         | Sum of trade volume that occurred at mid.<br/>TradePrice = NBBO MidPoint                                                                                                                                                                             |
| 44  | <code>TradeAtMidAsk</code>         | Q,T  | Number                        | 0         | Sum of ask volume that occurred between the mid and ask:<br/>(Trade Price > NBBO Mid) &amp; (Trade Price &lt; NBBO Ask)                                                                                                                                     |
| 45  | <code>TradeAtAsk</code>            | Q,T  | Number                        | 0         | Sum of trade volume that occurred at or above the Ask.                                                                                                                                                                                           |
| 46  | <code>TradeAtCrossOrLocked</code>  | Q,T  | Number                        | 0         | Sum of trade volume for bar when national best bid/offer is locked or crossed. <br>Locked is Bid = Ask <br>Crossed is Bid > Ask                                                                                                                  |
| 47  | <code>Volume</code>                | T    | Number                        | 0         | Total number of shares traded                                                                                                                                                                                                                    |
| 48  | <code>TotalTrades</code>           | T    | Number                        | 0         | Total number of trades                                                                                                                                                                                                                           |
| 49  | <code>FinraVolume</code>           | T    | Number                        | 0         | Number of shares traded that are reported by FINRA. <br/>Trades reported by FINRA are from broker-dealer internalization, dark pools, Over-The-Counter, etc.<br/>FINRA trades represent volume that is hidden or not public available to trade.         |
| 50  | <code>UptickVolume</code>          | T    | Integer                       | 0         | Total number of shares traded with upticks during bar.<br/>An uptick = ( trade price > last trade price )                                                                                                                                                                                                                               |
| 51  | <code>DowntickVolume</code>        | T    | Integer                       | 0         | Total number of shares traded with downticks during bar.<br/>A downtick = ( trade price &lt; last trade price )                                                                                                                                                                                                                            |
| 52  | <code>RepeatUptickVolume</code>    | T    | Integer                       | 0         | Total number of shares where trade price is the same (repeated) and last price change was up during bar. <br/>Repeat uptick = ( trade price == last trade price ) &amp; (last tick direction == up )                                                                                                                                         |
| 53  | <code>RepeatDowntickVolume</code>  | T    | Integer                       | 0         | Total number of shares where trade price is the same (repeated) and last price change was down during bar. <br/>Repeat downtick = ( trade price == last trade price ) &amp; (last tick direction == down )                                                                                                                                   |
| 54  | <code>UnknownVolume</code>         | T    | Integer                       | 0         | When the first trade of the day takes place, the tick direction is “unknown” as there is no previous Trade to compare it to.<br/>This field is the volume of the first trade after 4am and acts as an initiation value for the tick volume directions.<br/>In future this bar will be renamed to <code>UnkownTickDirectionVolume</code> .  |</p>

<h3>Notes</h3>

<p><strong>Empty Fields</strong></p>

<p>An empty field has no value and is “Blank” , for example FirstTradeTime and there are no trades during the bar period. 
The field <code>Volume</code> measuring total number of shares traded in bar will be <code>0</code> if there are no Trades (see <code>No Value</code> column above for each field).</p>

<p><strong>No Bid/Ask/Trade OHLC</strong></p>

<p>During a bar timeframe there may not be a change in the NBBO or an actual Trade. 
For example, there can be a bar with OHLC Bid/Ask but no Trade OHLC.</p>

<p><strong>Single Event</strong></p>

<p>For bars with only one trade, one NBBO bid or one NBBO ask then Open/High/Low/Close price,size andtime will be the same.</p>

<p><strong><code>AskPriceAtHighBidPrice</code>, <code>AskSizeAtHighBidPrice</code>, <code>AskPriceAtLowBidPrice</code>, <code>AskSizeAtLowBidPrice</code> Fields</strong> </p>

<p>To provide consistent Bid/Ask prices at a point in time while showing the low/high Bid/Ask for the bar, AlgoSeek uses the low/high <code>Bid</code> and the corresponding <code>Ask</code> at that price.</p>

<h2>FAQ</h2>

<p><strong>Why are Trade Prices often inside the Bid Price to Ask Price range?</strong></p>

<p>The Low/High Bid/Ask is the low and high NBBO price for the bar range. 
Very often a Trade may not occur at these prices as the price may only last a few seconds or executions are being crossed at mid-point due to hidden order types that execute at mid-point or as price improvement over current <code>Bid</code>/<code>Ask</code>.</p>

<p><strong>How to get exchange tradable shares?</strong> </p>

<p>To get the exchange tradable volume in a bar subtract <code>Volume</code> from <code>FinraVolume</code>. 
- <code>Volume</code> is the total number of shares traded. 
- <code>FinraVolume</code> is the total number of shares traded that are reported as executions by FINRA. </p>

<p>When a trade is done that is off the listed exchanges, it must be reported to FINRA by the brokerage firm or dark pool. Examples include: 
- internal crosses by broker dealer
- over-the-counter block trades, and
- dark pool executions.</p>
